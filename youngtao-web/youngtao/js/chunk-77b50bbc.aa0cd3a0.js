(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-77b50bbc"],{1339:function(t,e,r){"use strict";var n=r("6280"),a=r.n(n);a.a},"3a0d":function(t,e,r){"use strict";r.d(e,"a",(function(){return a}));var n=r("6b02");function a(t){return Object(n["a"])({url:"gsc/order/create",method:"post",data:JSON.stringify(t)})}},"3ffe":function(t,e,r){"use strict";r.r(e);var n=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("div",{directives:[{name:"loading",rawName:"v-loading.fullscreen",value:t.loading,expression:"loading",modifiers:{fullscreen:!0}}],staticClass:"container mb-5",attrs:{"element-loading-text":"订单创建中，请稍后"}},[r("el-steps",{staticClass:"pt-3 pb-2",attrs:{space:150,active:2,"finish-status":"success"}},[r("el-step",{attrs:{title:"购物车"}}),r("el-step",{attrs:{title:"确认订单"}}),r("el-step",{attrs:{title:"支付"}}),r("el-step",{attrs:{title:"完成"}})],1),r("div",{staticClass:"pb-3"},[r("div",{staticClass:"mb-2",staticStyle:{"font-weight":"600"}},[t._v("选择收货地址")]),r("el-row",{attrs:{gutter:20}},[t._l(t.userAddress,(function(e){return r("el-col",{key:e.id,attrs:{md:6}},[r("div",{staticClass:"addr-card",class:{active:e.isDefault},on:{click:function(r){return t.changeAddr(e.id,r)}}},[r("div",{staticClass:"addr-header"},[t._v(" "+t._s(e.consignee)+" ")]),r("div",{staticClass:"addr-content"},[r("div",[t._v(t._s(e.address))]),r("div",[t._v(t._s(e.detail)+" "+t._s(e.postcode))]),r("div",[t._v(t._s(e.telephone))])])])])})),r("el-col",{attrs:{md:6}},[r("el-button",{staticClass:"add-btn",attrs:{icon:"el-icon-plus",circle:""},on:{click:t.goAddAddr}})],1)],2)],1),r("div",{staticClass:"table-responsive-lg"},[r("div",{staticClass:"mb-2",staticStyle:{"font-weight":"600"}},[t._v("确认商品信息")]),r("div",{staticClass:"pb-1"},[r("table",{staticClass:"table"},[t._m(0),r("div",{staticStyle:{height:"10px"}}),t._l(t.orderList,(function(e){return r("tbody",{key:e.merchatId},[r("tr",{staticClass:"bg-light"},[r("td",{attrs:{colspan:"6"}},[r("i",{staticClass:"el-icon-shopping-bag-1"}),t._v(" "+t._s(e.shopName)+" ")])]),t._l(e.skuList,(function(e){return r("tr",{key:e.skuId},[r("td",[r("img",{attrs:{src:e.image,width:"30px",alt:"图片"}}),t._v(" "+t._s(e.spu)+" ")]),r("td",t._l(Object.keys(e.sku),(function(n){return r("div",{key:n},[r("span",{staticClass:"table-sku"},[t._v(t._s(n)+": "+t._s(e.sku[n])+" ")])])})),0),r("td",[r("span",[t._v(" "+t._s(e.price)+" ")])]),r("td",[r("span",[t._v(" x "+t._s(e.count)+" ")])]),r("td",[t._v(" 无 ")]),r("td",[r("span",[t._v(" "+t._s(e.price*e.count)+" ")])])])})),r("tr",[r("td",{attrs:{colspan:"6"}},[r("span",{staticClass:"text-muted"},[t._v("备注：")]),r("input",{directives:[{name:"model",rawName:"v-model",value:e.remark,expression:"merchant.remark"}],staticClass:"remark",attrs:{placeholder:"补充填写其他信息，如有快递不到也请留言"},domProps:{value:e.remark},on:{input:function(r){r.target.composing||t.$set(e,"remark",r.target.value)}}})])]),r("div",{staticStyle:{height:"20px"}})],2)}))],2)])]),r("div",{staticClass:"buy-paybar clearfix"},[r("div",{staticClass:"float-left"},[r("el-link",{staticStyle:{"line-height":"40px"},on:{click:function(e){return t.$router.go(-1)}}},[r("i",{staticClass:"el-icon-arrow-left pl-2"}),t._v(" 返回 ")])],1),r("div",{staticClass:"float-right"},[r("span",{staticClass:"pr-3"},[t._v(" 共有 "),r("span",{staticStyle:{color:"#ff5777"}},[t._v(t._s(t.skuCount))]),t._v(" 件商品， 共计"),r("span",{staticStyle:{color:"#ff5777","font-size":"20px"}},[t._v("￥"+t._s(t.payMoney))])]),r("el-button",{attrs:{type:"primary"},on:{click:t.createOrder}},[t._v("确认并付款")])],1)])],1)},a=[function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("thead",[r("th",[t._v("商品")]),r("th",[t._v("商品信息")]),r("th",[t._v("单价(元)")]),r("th",[t._v("数量")]),r("th",[t._v("优惠")]),r("th",[t._v("小计(元)")])])}],s=r("dcfe"),i=s["a"],c=(r("1339"),r("2877")),o=Object(c["a"])(i,n,a,!1,null,"4d892494",null);e["default"]=o.exports},"4b25":function(t,e,r){"use strict";r.d(e,"b",(function(){return a})),r.d(e,"a",(function(){return s})),r.d(e,"c",(function(){return i}));r("99af");var n=r("6b02");function a(){return Object(n["a"])({url:"gsc/product/timeMenu",method:"get"})}function s(t,e,r){return Object(n["a"])({url:"gsc/product/listByTime/".concat(t,"/").concat(e,"/").concat(r),method:"get"})}function i(t){return Object(n["a"])({url:"gsc/product/confirmOrder",method:"post",data:JSON.stringify(t)})}},"4df4":function(t,e,r){"use strict";var n=r("0366"),a=r("7b0b"),s=r("9bdd"),i=r("e95a"),c=r("50c4"),o=r("8418"),u=r("35a1");t.exports=function(t){var e,r,d,l,f,h,v=a(t),p="function"==typeof this?this:Array,b=arguments.length,m=b>1?arguments[1]:void 0,y=void 0!==m,g=u(v),O=0;if(y&&(m=n(m,b>2?arguments[2]:void 0,2)),void 0==g||p==Array&&i(g))for(e=c(v.length),r=new p(e);e>O;O++)h=y?m(v[O],O):v[O],o(r,O,h);else for(l=g.call(v),f=l.next,r=new p;!(d=f.call(l)).done;O++)h=y?s(l,m,[d.value,O],!0):d.value,o(r,O,h);return r.length=O,r}},6280:function(t,e,r){},"7de9":function(t,e,r){"use strict";r.d(e,"b",(function(){return a})),r.d(e,"a",(function(){return s}));var n=r("6b02");function a(t){return Object(n["a"])({url:"gmc/product/".concat(t),method:"get"})}function s(t){return Object(n["a"])({url:"gmc/product/confirmOrder",method:"post",data:JSON.stringify(t)})}},"8c95":function(t,e,r){"use strict";r.d(e,"a",(function(){return a})),r.d(e,"e",(function(){return s})),r.d(e,"c",(function(){return i})),r.d(e,"d",(function(){return c})),r.d(e,"b",(function(){return o})),r.d(e,"f",(function(){return u}));var n=r("6b02");function a(t){return Object(n["a"])({url:"omc/order/create",method:"post",data:JSON.stringify(t)})}function s(t){return Object(n["a"])({url:"/omc/order/queryStatus",method:"post",data:{id:t}})}function i(t){return Object(n["a"])({url:"omc/order/getUserOrder",method:"post",data:JSON.stringify(t)})}function c(t){return Object(n["a"])({url:"omc/order/orderRefund",method:"post",data:JSON.stringify(t)})}function o(t){return Object(n["a"])({url:"omc/order/delete",method:"post",data:JSON.stringify(t)})}function u(t){return Object(n["a"])({url:"omc/order/recover",method:"post",data:JSON.stringify(t)})}},a630:function(t,e,r){var n=r("23e7"),a=r("4df4"),s=r("1c7e"),i=!s((function(t){Array.from(t)}));n({target:"Array",stat:!0,forced:i},{from:a})},b0c0:function(t,e,r){var n=r("83ab"),a=r("9bf2").f,s=Function.prototype,i=s.toString,c=/^\s*function ([^ (]*)/,o="name";n&&!(o in s)&&a(s,o,{configurable:!0,get:function(){try{return i.call(this).match(c)[1]}catch(t){return""}}})},b85c:function(t,e,r){"use strict";r.d(e,"a",(function(){return s}));r("a4d3"),r("e01a"),r("d28b"),r("e260"),r("d3b7"),r("3ca3"),r("ddb0"),r("a630"),r("fb6a"),r("b0c0"),r("25f0");function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function a(t,e){if(t){if("string"===typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(r):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}function s(t){if("undefined"===typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(t=a(t))){var e=0,r=function(){};return{s:r,n:function(){return e>=t.length?{done:!0}:{done:!1,value:t[e++]}},e:function(t){throw t},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var n,s,i=!0,c=!1;return{s:function(){n=t[Symbol.iterator]()},n:function(){var t=n.next();return i=t.done,t},e:function(t){c=!0,s=t},f:function(){try{i||null==n["return"]||n["return"]()}finally{if(c)throw s}}}}},c6ca:function(t,e,r){"use strict";r.d(e,"c",(function(){return a})),r.d(e,"a",(function(){return s})),r.d(e,"d",(function(){return i})),r.d(e,"b",(function(){return c}));var n=r("6b02");function a(){return Object(n["a"])({url:"uac/shippingAddress/getUserAddress",method:"get"})}function s(t){return Object(n["a"])({url:"uac/shippingAddress/addOrUpdate",method:"post",data:JSON.stringify(t)})}function i(t){return Object(n["a"])({url:"uac/shippingAddress/setDefault",method:"post",data:JSON.stringify(t)})}function c(t){return Object(n["a"])({url:"uac/shippingAddress/delete",method:"post",data:JSON.stringify(t)})}},dcfe:function(t,e,r){"use strict";(function(t){var n=r("b85c"),a=r("d4ec"),s=r("bee2"),i=r("262e"),c=r("2caf"),o=r("9ab4"),u=r("60a3"),d=r("8c95"),l=r("3a0d"),f=r("4b25"),h=r("7de9"),v=r("c6ca"),p=function(e){Object(i["a"])(o,e);var r=Object(c["a"])(o);function o(){var t;return Object(a["a"])(this,o),t=r.apply(this,arguments),t.loading=!1,t.currentOrder={},t.userAddress=[],t.orderList=[],t.skuCount=0,t.payMoney=0,t}return Object(s["a"])(o,[{key:"confirmOrder",value:function(){var t=this;this.currentOrder=this.$utils.getOrderItem(this.$route.params.id),this.currentOrder.type===this.$orderType.NORMAL?Object(h["a"])({skuList:this.currentOrder.skuList}).then((function(e){null==e.data&&t.$router.back(),t.orderList=e.data,t.calculate()})):Object(f["c"])({skuId:this.currentOrder.skuList[0].skuId}).then((function(e){var r=e.data;t.orderList=[r],t.calculate()}))}},{key:"calculate",value:function(){var t,e=Object(n["a"])(this.orderList);try{for(e.s();!(t=e.n()).done;){var r=t.value;r.remark=""}}catch(d){e.e(d)}finally{e.f()}var a,s=Object(n["a"])(this.orderList);try{for(s.s();!(a=s.n()).done;){var i,c=a.value,o=Object(n["a"])(c.skuList);try{for(o.s();!(i=o.n()).done;){var u=i.value;this.skuCount++,this.payMoney+=u.price*u.count}}catch(d){o.e(d)}finally{o.f()}}}catch(d){s.e(d)}finally{s.f()}}},{key:"getUserAddress",value:function(){var t=this;Object(v["c"])().then((function(e){t.$log.info("获取用户收货地址",e),t.userAddress=e.data;var r,a=Object(n["a"])(t.userAddress);try{for(a.s();!(r=a.n()).done;){var s=r.value;if(s.isDefault){t.checkedAddress=s.id;break}}}catch(i){a.e(i)}finally{a.f()}}))}},{key:"mounted",value:function(){this.confirmOrder(),this.getUserAddress()}},{key:"createOrder",value:function(){var t=this;if(this.checkedAddress)if(this.currentOrder.type===this.$orderType.NORMAL){var e,r=[],a=Object(n["a"])(this.orderList);try{for(a.s();!(e=a.n()).done;){var s,i=e.value,c=[],o=Object(n["a"])(i.skuList);try{for(o.s();!(s=o.n()).done;){var u=s.value;c.push({skuId:u.skuId,count:u.count})}}catch(v){o.e(v)}finally{o.f()}r.push({orderItem:c,remark:i.remark})}}catch(v){a.e(v)}finally{a.f()}var f={orderList:r,shippingAddressId:this.checkedAddress,isCart:this.currentOrder.isCart};Object(d["a"])(f).then((function(e){t.checkOrderStatus(e.data)}))}else{var h={skuId:this.orderList[0].skuList[0].skuId,remark:this.orderList[0].remark,shippingAddressId:this.checkedAddress,isCart:this.currentOrder.isCart};Object(l["a"])(h).then((function(e){t.checkOrderStatus(e.data)}))}else this.$message({type:"info",message:"请添加收货地址"})}},{key:"checkOrderStatus",value:function(t){var e=this;this.loading=!0,this.queueTimer=setInterval((function(){Object(d["e"])(t).then((function(r){r.data&&r.data===e.$orderStatus.PAYMENT?(e.loading=!1,e.queueTimer&&clearInterval(e.queueTimer),e.$router.push("/order/pay/".concat(t))):r.data&&r.data===e.$orderStatus.FAILED&&(e.$message({type:"info",message:"订单创建失败"}),e.loading=!1,e.queueTimer&&clearInterval(e.queueTimer))}))}),2e3)}},{key:"changeAddr",value:function(e,r){var n=t(r.currentTarget);t(".addr-card").removeClass("active"),n.addClass("active"),this.checkedAddress=e}},{key:"goAddAddr",value:function(){var t=this.$router.resolve("/user/address");window.open(t.href,"_blank")}}]),o}(u["e"]);p=Object(o["a"])([u["a"]],p),e["a"]=p}).call(this,r("1157"))}}]);
//# sourceMappingURL=chunk-77b50bbc.aa0cd3a0.js.map